<!-- Coded by Omar and Youssef-->
<!DOCTYPE html>
{% load static %} 
<html>
    <head>
        <title>Manual Comparison</title>
<!--<link href="{% static 'style/css.css' %}" rel="stylesheet" type="text/css" > ---> 
    </head>
    <body>
        <div class="heading">
			<span class="Sub_introduction"></span>
				<div class = "Buttons">
					<a href="/"><button class="Home">
						Home
					</button></a>
					<a href="/import"><button class="Upload">
						Upload
					</button></a>
					<a href="/user"><button class="User_comparison">
						User Comparison
					</button></a>
					<a href="/color"><button class="Color_comparison">
						Color Comparison
					</button></a>
				</div>
				</head>
				<body>
					<div class="Main_tool">
						<span class="Main_title">Manual Comparison</span>
							<div class="tooltip">
							?/i
							<span class="tooltiptext">To use the manual comparison, first select which graph type you want to show on the left and right side of the page. Once the graphs are selected, you can use the drop down menu for either side of the page to select the map, user and the map version you want to be shown in each visualization. On this page only 1 user can be shown at a time per visualization.</span>
						</div>
        			</div>
					<div class="Select_graph">
						<span class = "left">Select graph type:</span>
						<span class = "right">Select graph type:</span>
					</div>
					<div class="Select_graph">
						<span class = "left1">Stimuli User Color:</span>
						<span class = "right">Stimuli User Color:</span>
					</div>

					<!-- SEE homepage/templates/home.HTML for the comments -->
					<span class = "dropdowns">
						Select visualization
						<select onchange="changeGraph(this.value)">
							{% for graph in graph_list %}
							<div>
								{% if graph != graphselection %}
									<option value="{{ graph }}">{{ graph }}</option>
								{% else %}
									<option selected="selected" value="{{ graph }}">{{ graph }}</option>
								{% endif %}
							</div>
							{% endfor %}
						</select>
						Select stimuli
						<select onchange="changeStimuli(this.value)">
							{% for stimuli in stimuli_list %}
							<div>
								{% if stimuli != selected_stimuli %}
									<option value="{{ stimuli }}">{{ stimuli }}</option>
								{% else %}
									<option selected="selected" value="{{ stimuli }}">{{ stimuli }}</option>
								{% endif %}
							</div>
							{% endfor %}
						</select>
						Select a user:
						<select onchange="changeUser(this.value)">
							{% for user in user_list %}
							<div>
								{% if user != selected_user %}
									<option value="{{ user }}">{{ user }}</option>
								{% else %}
									<option selected="selected" value="{{ user }}">{{ user }}</option>
								{% endif %}
							</div>
							{% endfor %}
						</select>
						Select the color:
						<select onchange="changeColor(this.value)">
							{% if "gray" != selected_color %}
							<option selected="selected" value="color">Color</option>
							<option value="gray">Gray</option>
							{% else %}
							<option value="color">Color</option>
							<option selected="selected" value="gray">Gray</option>
							{% endif %}
						</select>
					</span>
				</span>
    </body>
	
	{{ graph_selected | safe }}

		</body>
		<!-- Start Coding Tarik Hacialiogullari -->
		{{ script_graph | safe }}
	<script>
		// <!-- SEE homepage/templates/home.HTML for the comments -->
		function changeGraph(graph)
		{
			var url = new window.URL(document.location);
			url.searchParams.set("graph", graph);
			window.location.href = url.toString();
		}
		
		function changeStimuli(stimuli) 
		{
			var url = new window.URL(document.location);
			url.searchParams.set("stimuli", stimuli);
			window.location.href = url.toString();
			// + '&user=' + 'p1';
		}

		function changeUser(user)
		{
			var url = new window.URL(document.location);
			url.searchParams.set("user", user);
			window.location.href = url.toString();
		}

		function changeColor(color)
		{
			var url = new window.URL(document.location);
			url.searchParams.set("color", color);
			window.location.href = url.toString();
		}

		function reverseBarchart(cb)
		{
			boolChecked = $(cb).prop("checked")
			var url = new window.URL(document.location);
			url.searchParams.set("brev", boolChecked);
			// if(boolChecked == true)
			// {
			window.location.href = url.toString();
    		// }
			// else{
        	// 	alert("FALSE");
    		// }
		}
		
	</script>
	
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js"></script>
<!-- css information for all classes-->
<style>
*{
	margin:0;
	padding:0;
}
html, body{
	height:100%;
}

body{
	background-color:#0c0129;
     background-image:url("/static/jpg/blue.jpg");	
     background-position:center;
     background-size:cover;
     background-blend-mode:soft-light;
 }

.heading{
     width:1500px;
     height:750px;
     margin:auto;
     position:absolute;
     top:0px; bottom:0px; right:0px; left:0px;
}
.Main_tool{
	text-align: center;
}
.Main_title{
	display: inline-block;
	text-align: center;
	color:white;
	font-size:38pt;
	font-family:big john;
}
.Sub_introduction{
	display:block;
	margin-top:15px;
	text-align: center;
	color:white;
	font-size:14pt;
	font-family:serif;
}
.tooltip {
  position: relative;
  display: inline-block;
  border-bottom: 1px dotted black;
  color: white;
  font-size: 24pt;
  text-align: center;
  border:2px solid white;
}
.tooltip .tooltiptext {
  visibility: hidden;
  width: 400px;
  background-color: black;
  color: #fff;
  border-radius: 10px;
  padding: 5px 0;
  font-size: 12pt;
  
  /* Position the tooltip */
  position: absolute;
  z-index: 1;
  top: 100%;
  left: 50%;
  margin-left: -200px;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
}
.Buttons{
	text-align: center;
}
.Home{
	text-align: center;
	display: inline-block;
	margin: 20px auto;
	width:180px;
	height:50px;
	border:3px solid white;
	background-color:rgba(255,255,255,0);
	color: white;
	font-family:sans-serif;
	font-weight:bold;
	border-radius: 5px;

	transition: background-color 1000ms, color 1000ms;
}
.Upload{
    text-align: center;
	display: inline-block;
	margin: 20px auto;
	width:180px;
	height:50px;
	border:3px solid white;
	background-color:rgba(255,255,255,0);
	color: white;
	font-family:sans-serif;
	font-weight:bold;
	border-radius: 5px;

	transition: background-color 1000ms, color 1000ms;
}
.User_comparison{
	text-align: center;
	margin: 20px auto;
	width:180px;
	height:50px;
	border:3px solid white;
	background-color:rgba(255,255,255,0);
	color: white;
	font-family:sans-serif;
	font-weight:bold;
	border-radius: 5px;
    display: inline-block;

	transition: background-color 1000ms, color 1000ms;
}

.Color_comparison{
	text-align: center;
	margin: 20px auto;
	width:180px;
	height:50px;
	border:3px solid white;
	background-color:rgba(255,255,255,0);
	color: white;
	font-family:sans-serif;
	font-weight:bold;
	border-radius: 5px;
    display: inline-block;

	transition: background-color 1000ms, color 1000ms;
}
.Select_graph{
	text-align: center;
	color: white;
	font-size: 24px;
}
.left{
	margin-right: 150px;
	display: inline-block;
}
.right{
	margin-left: 600px;
	display: inline-block;
}
.left1{
	margin-right: 150px;
	display: inline-block;
}
select {
  -webkit-appearance: none;
  -moz-appearance: none;
  -ms-appearance: none;
  appearance: none;
  outline: 0;
  box-shadow: none;
  border: 0 !important;
  background: #2c3e50;
  background-image: none;
}
select::-ms-expand {
  display: none;
}
.select {
  position: relative;
  display: flex;
  width: 20em;
  height: 3em;
  line-height: 3;
  background: #2c3e50;
  overflow: hidden;
  border-radius: .25em;
}
select {
  flex: 1;
  padding: 0 .5em;
  color: #fff;
  cursor: pointer;
}
.select::after {
  content: '\25BC';
  position: absolute;
  top: 0;
  right: 0;
  padding: 0 1em;
  background: #34495e;
  cursor: pointer;
  pointer-events: none;
  -webkit-transition: .25s all ease;
  -o-transition: .25s all ease;
  transition: .25s all ease;
}
.select:hover::after {
  color: #f39c12;
}
.Home:hover{
	background-color:rgba(255,255,255,1);
	color:#222;
	cursor:pointer;

	transition: background-color 1000ms, color 1000ms;
}
.Upload:hover{
	background-color:rgba(255,255,255,1);
	color:#222;
	cursor:pointer;

	transition: background-color 1000ms, color 1000ms;
}
.User_comparison:hover{
	background-color:rgba(255,255,255,1);
	color:#222;
	cursor:pointer;

	transition: background-color 1000ms, color 1000ms;
}
.Color_comparison:hover{
	background-color:rgba(255,255,255,1);
	color:#222;
	cursor:pointer;

	transition: background-color 1000ms, color 1000ms;
}

/* Start Coding Tarik Hacialiogullari retrieved from https://www.w3schools.com/howto/howto_css_switch.asp */

/* The switch - the box around the slider */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

/* Hide default HTML checkbox */
.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

/* The slider */
.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

/* End Coding Tarik Hacialiogullari retrieved from https://www.w3schools.com/howto/howto_css_switch.asp */
</style>
</html>


<!-- 
	# Generated en coded by Tarik Hacialiogullari except where noted.
from django.shortcuts import render

from django.http import HttpResponse

from bokeh.embed import components
from bokeh.layouts import row, gridplot

from homepage.models import getUserData, getAllStimulis, getAllUsersByStimuli

from visualization_heatmap.views import getGraph as getGraphContour

from visualization_gazeplot.views import getGraph as getGraphGaze
from visualization_gazeplot.views import addUserToGraph as addUserToGraphGaze

from visualization_barchart.views import getGraph as getGraphBar
from visualization_barchart.views import addUserToGraph as addUserToGraphBar

from visualization_linechart.views import getGraph as getGraphLine
from visualization_linechart.views import addUserToGraph as addUserToGraphLine

#Some of them are for background not sure which one, just putting all in it m8.
import eye_tracking_visualizations_group23a.settings
from PIL import Image
import requests
from io import BytesIO
from django.contrib.staticfiles.storage import staticfiles_storage

#SEE homepage/views.py for the comments
def home(request):
    toolbar = "box_select, lasso_select, wheel_zoom, pan, reset, save, hover, help"

    #stimuli has to be the same for left and right
    stimuli = '06_Hamburg_S1.jpg'
    user_left = 'p1'
    color_left = 'color'
    brev_left = False
    graph_left = 'gaze'

    user_right = 'p1'
    color_right = 'color'
    brev_right = False
    graph_right = 'gaze'

    if request.GET.get('stimuli') is not None:
        stimuli = request.GET['stimuli']
        print('STIMULI IS RECEIVED:' + stimuli)

    if request.GET.get('user_left') is not None:
        user_left = request.GET['user_left']
        print('USER IS RECEIVED:' + user_left)
    if request.GET.get('user_right') is not None:
        user_right = request.GET['user_right']
        print('USER IS RECEIVED:' + user_right)

    if request.GET.get('color_left') is not None:
        color_left = request.GET['color_left']
        print('COLOR IS RECEIVED:' + color_left)
    if request.GET.get('color_right') is not None:
        color_right = request.GET['color_right']
        print('COLOR IS RECEIVED:' + color_right)
    
    #same as stimuli but for barchart so that you can reverse it order.
    if request.GET.get('brev_left') is not None:
        brev_left = parseToBool(request.GET['brev_left'].lower())
        print('BREV IS RECEIVED:' + str(brev_left))
    if request.GET.get('brev_right') is not None:
        brev_right = parseToBool(request.GET['brev_right'].lower())
        print('BREV IS RECEIVED:' + str(brev_right))

    # Coded by Laura
    if request.GET.get('graph_left') is not None:
        graph_left = request.GET['graph_left']
        print('GRAPH IS RECEIVED' + graph_left)
    if request.GET.get('graph_right') is not None:
        graph_right = request.GET['graph_right']
        print('GRAPH IS RECEIVED' + graph_right)
        # end coding Laura

    #getData
    df_userLeft = getUserData(user_left, stimuli, color_left)
    df_userRight = getUserData(user_right, stimuli, color_right)

    # ---Start Coding by Fanni Egresits
    #GetBackground images
    url = '/static/stimuli/{}'.format(stimuli)
    img_url = "http://" + request.get_host() + url

        #Get the parameters of map (width, height)
    response = requests.get(img_url)
    w, h = Image.open(BytesIO(response.content)).size
    # ---End Coding by Fanni Egresits

    # Coded by Fanni and Laura
    selected_graph_left = 0
    script_graph_left = 0

    if graph_left == 'gaze':
        selected_graph_left = getGraphGaze(toolbar, url, w, h)
        addUserToGraphGaze(df_userLeft, selected_graph_left, 'red')
        script_graph_left, selected_graph_left = components(selected_graph_left)
    elif graph_left == 'line':
        selected_graph_left = getGraphLine(toolbar)
        addUserToGraphLine(df_userLeft, selected_graph_left, 'red')
        script_graph_left, selected_graph_left = components(selected_graph_left)
    elif graph_left == 'bar':
        end = len(df_userLeft.index) + 1000
        selected_graph_left = getGraphBar(toolbar, end)
        addUserToGraphBar(df_userLeft, selected_graph_left, 'red', 0, brev_left)
        script_graph_left, selected_graph_left = components(selected_graph_left)
    elif graph_left == 'contour':
        selected_graph_left = getGraphContour(df_userLeft, url, w, h)

    selected_graph_right = 0
    script_graph_right = 0
    if graph_right == 'gaze':
        selected_graph_right = getGraphGaze(toolbar, url, w, h)
        addUserToGraphGaze(df_userRight, selected_graph_right, 'red')
        script_graph_right, selected_graph_right = components(selected_graph_right)
    elif graph_right == 'line':
        selected_graph_right = getGraphLine(toolbar)
        addUserToGraphLine(df_userRight, selected_graph_right, 'red')
        script_graph_right, selected_graph_right = components(selected_graph_right)
    elif graph_right == 'bar':
        end = len(df_userRight.index) + 1000
        selected_graph_right = getGraphBar(toolbar, end)
        addUserToGraphBar(df_userRight, selected_graph_right, 'red', 0, brev_right)
        script_graph_right, selected_graph_right = components(selected_graph_right)
    elif graph_right == 'contour':
        selected_graph_right = getGraphContour(df_userRight, url, w, h)
    
        #end coding Fanni and Laura

    #Stimuli dropdown
    stimuli_list = getAllStimulis()
    user_list = getAllUsersByStimuli(stimuli)
    graph_list = {'gaze', 'contour', 'bar', 'line'}

    #Updated from homepage context by Fanni and Laura
    context = {
        'selected_graph_left' : selected_graph_left,
        'selected_graph_right' : selected_graph_right,
        'graph_left' : graph_left,
        'graph_right' : graph_right,
        'selected_stimuli': stimuli,
        'selected_user_left': user_left,
        'selected_user_right' : user_right,
        'selected_color_left': color_left,
        'selected_color_right': color_right,
        'stimuli_list': stimuli_list,
        'user_list': user_list,
        'script_graph_left': script_graph_left,
        'script_graph_right': script_graph_right,
        'graph_list' : graph_list
    }
    return render(request, 'manual.html', context)

#Function from https://stackoverflow.com/a/53287252/4641129 to convert text content to boolean type. (only changed the function name)
def parseToBool(string):
    d = {'true': True, 'false': False}
    return d.get(string, string)
-->